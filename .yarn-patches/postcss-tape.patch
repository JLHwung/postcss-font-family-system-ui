diff --git a/index.js b/index.js
index 9809fd7cc2575a1552e0161c5abc977cc09b83d1..bb8a369fc7526b78a12ab8a672c1a665d3c8b2ea 100755
--- a/index.js
+++ b/index.js
@@ -1,3 +1,3 @@
 #!/usr/bin/env node
-function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function _interopNamespace(e){if(e&&e.__esModule)return e;var r={};return e&&Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r.default=e,r}var fs=_interopDefault(require("fs")),readline=_interopDefault(require("readline")),path=_interopDefault(require("path"));function exitFail(e){console.log(e),process.exit(1)}function exitPass(){process.exit(0)}function readFile(e){return new Promise((r,t)=>{fs.readFile(e,"utf8",(e,n)=>{e?t(e):r(n)})})}function readJSON(e,...r){return readFile(e).then(e=>JSON.parse(e)).then(e=>r.length?e[Object.keys(e).find(e=>r.includes(e))]:e).catch(()=>({}))}function readOrWriteFile(e,r){return readFile(e).catch(()=>writeFile(e,r||"").then(()=>""))}function safelyReadFile(e){return readFile(e).catch(()=>"")}function writeFile(e,r){return new Promise((t,n)=>{fs.writeFile(e,r,e=>{e?n(e):t()})})}const colors={reset:"[0m",bold:"[1m",dim:"[2m",underline:"[4m",blink:"[5m",reverse:"[7m",hidden:"[8m",black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m",bgBlack:"[40m",bgRed:"[41m",bgGreen:"[42m",bgYellow:"[43m",bgBlue:"[44m",bgMagenta:"[45m",bgCyan:"[46m",bgWhite:"[47m"};function color(e,r){return colors[e]+r.replace(colors.reset,colors.reset+colors[e])+colors.reset}const isWin32="win32"===process.platform,tick=isWin32?"√":"✔",cross=isWin32?"×":"✖",stdout=process.stdout;let interval;function pass(e,r,t){clearInterval(interval),t?stdout.write(` ${color("green",tick)}\n`):(readline.clearLine(stdout,0),readline.cursorTo(stdout,0),stdout.write(`${color("green",tick)} ${e} ${color("dim",r)}\n`))}function fail(e,r,t,n){clearInterval(interval),n?stdout.write(` ${color("red",cross)}\n${t}\n`):(readline.clearLine(stdout,0),readline.cursorTo(stdout,0),stdout.write(`${color("red",cross)} ${e} ${color("dim",r)}\n${t}\n`))}function wait(e,r,t){if(t)stdout.write(`${e} ${color("dim",r)}`);else{const t=isWin32?"-–—–-":"⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏";let n=0;clearInterval(interval),readline.clearLine(stdout,0),readline.cursorTo(stdout,0),stdout.write(`${color("yellow",t[n])} ${e} ${color("dim",r)}`),interval=setInterval(()=>{n=(n+1)%t.length,readline.cursorTo(stdout,0),stdout.write(`${color("yellow",t[n])} ${e} ${color("dim",r)}`)},60)}}function getErrorMessage(e){return Object(e).message||e}const argRegExp=/^--([\w-]+)$/,primativeRegExp=/^(false|null|true|undefined|(\d+\.)?\d+|\{.*\}|\[.*\])$/,relaxedJsonPropRegExp=/(['"])?([a-z0-9A-Z_]+)\1:/g,relaxedJsonValueRegExp=/("[a-z0-9A-Z_]+":\s*)(?!true|false|null|\d+)'?([A-z0-9]+)'?([,}])/g;function getOptionsFromArguments(e){return process.argv.slice(2).reduce((e,r,t,n)=>{const i=n[t+1],s=r.match(argRegExp);if(s){const[,r]=s;!i||argRegExp.test(i)?e[r]=!0:e[r]=primativeRegExp.test(i)?JSON.parse(i.replace(relaxedJsonPropRegExp,'"$2": ').replace(relaxedJsonValueRegExp,'$1"$2"$3')):i}return e},Object.assign({},e))}async function getOptions(){const e=process.cwd(),r={plugin:e,config:e,fixtures:path.resolve(e,"test")},t=await readJSON("package.json","postcss","postcssConfig").then(e=>getOptionsFromArguments(Object.assign(r,e))),n=path.resolve(t.plugin),i=await new Promise(function(e){e(_interopNamespace(require(n)))});t.plugin=i;try{const e=path.extname(t.config)?path.resolve(t.config):path.resolve(t.config,"postcss-tape.config.js"),r=await new Promise(function(r){r(_interopNamespace(require(e)))});t.config=r.default||r}catch(e){const r=path.resolve(t.config,".tape.js"),n=await new Promise(function(e){e(_interopNamespace(require(r)))});t.config=n.default||n}return t}getOptions().then(async e=>{let r=!1;for(const t in e.config){const n=e.config[t],i="function"==typeof Object(n.plugin).process?n.plugin:"function"==typeof n.plugin?{process:n.plugin}:e.plugin,s=t.split(":")[0],o=t.split(":").join("."),a=path.resolve(e.fixtures,n.source||`${s}.css`),c=path.resolve(e.fixtures,n.expect||`${o}.expect.css`),l=path.resolve(e.fixtures,n.result||`${o}.result.css`),u=Object.assign({from:a,to:l},n.processOptions),g=n.options,f=Object(i.postcss).postcssPlugin||"postcss";wait(f,n.message,e.ci);try{Object(n.before)instanceof Function&&await n.before();const t=await safelyReadFile(c),s=await readOrWriteFile(a,t),o=await i.process(s,u,g),p=o.css;if(e.fix)await writeFile(c,p),await writeFile(l,p);else if(await writeFile(l,p),t!==p)throw new Error([`Expected: ${JSON.stringify(t).slice(1,-1)}`,`Received: ${JSON.stringify(p).slice(1,-1)}`].join("\n"));const d=o.warnings();if("number"==typeof n.warnings){if(n.warnings!==d.length){const e=1!==d.length?"s":"";throw new Error(`Expected: ${n.warnings} warning${e}\nReceived: ${d.length} warnings`)}}else if(d.length){if(!d.every(e=>n.warnings===Object(n.warnings)&&Object.keys(n.warnings).every(r=>n.warnings[r]instanceof RegExp?n.warnings[r].test(e[r]):n.warnings[r]===e[r]))){const e=1!==d.length?"s":"";throw new Error(`Unexpected warning${e}:\n${d.join("\n")}`)}}else{if(n.warnings)throw new Error("Expected a warning");if(n.errors)throw new Error("Expected an error")}Object(n.after)instanceof Function&&await n.after(),pass(f,n.message,e.ci)}catch(t){if("error"in n){if(n.error===Object(n.error)){if(Object.keys(n.error).every(e=>n.error[e]instanceof RegExp?n.error[e].test(Object(t)[e]):n.error[e]===Object(t)[e]))pass(f,n.message,e.ci);else{const i=Object.keys(n.error).reduce((e,r)=>Object.assign(e,{[r]:Object(t)[r]}),{});r=t,fail(f,n.message,`  Expected Error: ${JSON.stringify(n.error)}\n  Received Error: ${JSON.stringify(i)}`,e.ci)}}else{if("boolean"==typeof n.error&&n.error?pass(f,n.message,e.ci):(r=t,fail(f,n.message,"  Expected Error",e.ci)),e.ci)break}}else r=t,fail(f,n.message,getErrorMessage(t),e.ci)}}if(r)throw r}).then(exitPass,exitFail);
+function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function r(e){if(e&&e.__esModule)return e;var r={};return e&&Object.keys(e).forEach((function(n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})})),r.default=e,r}var n=e(require("fs")),t=e(require("readline")),s=e(require("path")),i=e(require("postcss"));function c(e){return new Promise((r,t)=>{n.readFile(e,"utf8",(e,n)=>{e?t(e):r(n)})})}function o(e,r){return c(e).catch(()=>a(e,r||"").then(()=>""))}function a(e,r){return new Promise((t,s)=>{n.writeFile(e,r,e=>{e?s(e):t()})})}const l={reset:"[0m",bold:"[1m",dim:"[2m",underline:"[4m",blink:"[5m",reverse:"[7m",hidden:"[8m",black:"[30m",red:"[31m",green:"[32m",yellow:"[33m",blue:"[34m",magenta:"[35m",cyan:"[36m",white:"[37m",bgBlack:"[40m",bgRed:"[41m",bgGreen:"[42m",bgYellow:"[43m",bgBlue:"[44m",bgMagenta:"[45m",bgCyan:"[46m",bgWhite:"[47m"};function f(e,r){return l[e]+r.replace(l.reset,l.reset+l[e])+l.reset}const u="win32"===process.platform,g=u?"√":"✔",w=u?"×":"✖",p=process.stdout;let m;function d(e,r,n){clearInterval(m),n?p.write(` ${f("green",g)}\n`):(t.clearLine(p,0),t.cursorTo(p,0),p.write(`${f("green",g)} ${e} ${f("dim",r)}\n`))}function b(e,r,n,s){clearInterval(m),s?p.write(` ${f("red",w)}\n${n}\n`):(t.clearLine(p,0),t.cursorTo(p,0),p.write(`${f("red",w)} ${e} ${f("dim",r)}\n${n}\n`))}function $(e,r,n){if(n)p.write(`${e} ${f("dim",r)}`);else{const n=u?"-–—–-":"⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏";let s=0;clearInterval(m),t.clearLine(p,0),t.cursorTo(p,0),p.write(`${f("yellow",n[s])} ${e} ${f("dim",r)}`),m=setInterval(()=>{s=(s+1)%n.length,t.cursorTo(p,0),p.write(`${f("yellow",n[s])} ${e} ${f("dim",r)}`)},60)}}function h(e){return Object(e).message||e}const y=/^--([\w-]+)$/,O=/^(false|null|true|undefined|(\d+\.)?\d+|\{.*\}|\[.*\])$/,j=/(['"])?([a-z0-9A-Z_]+)\1:/g,v=/("[a-z0-9A-Z_]+":\s*)(?!true|false|null|\d+)'?([A-z0-9]+)'?([,}])/g;(async function(){const e=process.cwd(),n={plugin:e,config:e,fixtures:s.resolve(e,"test")},t=await function(e,...r){return c(e).then(e=>JSON.parse(e)).then(e=>r.length?e[Object.keys(e).find(e=>r.includes(e))]:e).catch(()=>({}))}("package.json","postcss","postcssConfig").then(e=>function(e){return process.argv.slice(2).reduce((e,r,n,t)=>{const s=t[n+1],i=r.match(y);if(i){const[,r]=i;!s||y.test(s)?e[r]=!0:e[r]=O.test(s)?JSON.parse(s.replace(j,'"$2": ').replace(v,'$1"$2"$3')):s}return e},Object.assign({},e))}(Object.assign(n,e))),i=s.resolve(t.plugin),o=await new Promise((function(e){e(r(require(i)))}));t.plugin=o.default||o;try{const e=s.extname(t.config)?s.resolve(t.config):s.resolve(t.config,"postcss-tape.config.js"),n=await new Promise((function(n){n(r(require(e)))}));t.config=n.default||n}catch(e){const n=s.resolve(t.config,".tape.js"),i=await new Promise((function(e){e(r(require(n)))}));t.config=i.default||i}return t})().then(async e=>{let r=!1;for(const t in e.config){const l=e.config[t];let f="function"==typeof Object(l.plugin).process?l.plugin:"function"==typeof l.plugin?{process:l.plugin}:e.plugin;const u=t.split(":")[0],g=t.split(":").join("."),w=s.resolve(e.fixtures,l.source||u+".css"),p=s.resolve(e.fixtures,l.expect||g+".expect.css"),m=s.resolve(e.fixtures,l.result||g+".result.css"),y=Object.assign({from:w,to:m},l.processOptions);f=f(l.options);const O=f.postcssPlugin||"postcss";$(O,l.message,e.ci);try{Object(l.before)instanceof Function&&await l.before();const r=await(n=p,c(n).catch(()=>"")),t=await o(w,r),s=await i([f]).process(t,y),u=s.css;if(e.fix)await a(p,u),await a(m,u);else if(await a(m,u),r!==u)throw new Error(["Expected: "+JSON.stringify(r).slice(1,-1),"Received: "+JSON.stringify(u).slice(1,-1)].join("\n"));const g=s.warnings();if("number"==typeof l.warnings){if(l.warnings!==g.length){const e=1!==g.length?"s":"";throw new Error(`Expected: ${l.warnings} warning${e}\nReceived: ${g.length} warnings`)}}else if(g.length){if(!g.every(e=>l.warnings===Object(l.warnings)&&Object.keys(l.warnings).every(r=>l.warnings[r]instanceof RegExp?l.warnings[r].test(e[r]):l.warnings[r]===e[r]))){const e=1!==g.length?"s":"";throw new Error(`Unexpected warning${e}:\n${g.join("\n")}`)}}else{if(l.warnings)throw new Error("Expected a warning");if(l.errors)throw new Error("Expected an error")}Object(l.after)instanceof Function&&await l.after(),d(O,l.message,e.ci)}catch(n){if("error"in l){if(l.error===Object(l.error)){if(Object.keys(l.error).every(e=>l.error[e]instanceof RegExp?l.error[e].test(Object(n)[e]):l.error[e]===Object(n)[e]))d(O,l.message,e.ci);else{const t=Object.keys(l.error).reduce((e,r)=>Object.assign(e,{[r]:Object(n)[r]}),{});r=n,b(O,l.message,`  Expected Error: ${JSON.stringify(l.error)}\n  Received Error: ${JSON.stringify(t)}`,e.ci)}}else{if("boolean"==typeof l.error&&l.error?d(O,l.message,e.ci):(r=n,b(O,l.message,"  Expected Error",e.ci)),e.ci)break}}else r=n,b(O,l.message,h(n),e.ci)}}var n;if(r)throw r}).then((function(){process.exit(0)}),(function(e){console.log(e),process.exit(1)}));
 //# sourceMappingURL=index.js.map
